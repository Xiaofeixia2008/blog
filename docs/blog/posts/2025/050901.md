---
title: 实体(2)
date:
  created: 2025-05-09
  updated: 2025-05-16
categories:
  - MC开发
tags:
  - 实体
slug: entity
description: 学完实体操作命令（改）后的总结和感想
readtime: 8
links:
  - 2.6.2 “改”实体：位置、朝向与属性操作 | 量筒的 Minecraft 基岩版开发文档: https://yzbwdlt.pages.dev/docs/commands/chapter2/section6/subsection2/
  - 生成事件 - 中文 Minecraft Wiki: https://zh.minecraft.wiki/w/生成事件
  - MCBEID表: https://ca.projectxero.top/idlist/
---

近期比较忙碌，学MC开发的时间比较少了，因此更新比较慢，请各位见谅。话说回来，大家还是要以学业为重啊，毕竟高考是不可能考MC的......（至少在广东是这样的）

<!-- more -->

这一节学习的是如何"改"实体。既然是改，那实体就得先存在，因此需要用到上一节的知识。那么究竟能够改什么呢？简单列个表：

- 位置
- 生成事件
- 状态效果
- 施加伤害
- 骑乘

那么接下来我们就来好好聊一下它们。

## 位置

首先来看位置。一个命令是`/tp`，这个好说，因为之前就学习过了。另外有一个比较低频的命令是`/spreadplayers`，要注意各个参数的顺序，它们依次是：x坐标，z坐标，最小间距，扩散半径，而要传送的目标被放在了最后面！这个和tp不一样，要特别留意。

/// note | 一点碎碎念
关于`/spreadplayers`，由于是新知识，有几个细节我还是想提一下的。

坐标只有x和z，没有y；最小间距可以是0，这样的话就真的是随机传送了。但是如果间距太大，传送范围太小，或者是要传送的实体太多了，使得无法满足间距大于所指定的情况，这个时候传送就会失败。

传送范围是**正方形**，中心点就是前面给的坐标，边长就是半径的2倍。

1.21.10版本追加了一个可选参数叫"最高高度"，而前面的坐标是不需要提供y的，这就不得不说一下传送的机制了。在不提供最高高度的情况下，会随机传送到范围内的**地表**上。何为地表？形象点讲，就是从y=320（主世界建筑限高，其他维度是不同的）出发，往下的第一个固体方块的上表面（还得往上一格），就叫地表（选地理的：这不就是下垫面吗），另外这个地表高度取决于随机到的目标点，而不是把所有随机传送点的y设为中心点地表的高度。在指定了最高高度之后，检测的起点就不是y＝320了，变为从指定高度出发所得到的地表高度了。地表高度知道了，但是还需要这个点的上方连续两格都得是空气，才能满足传送的条件。
///

## 生成事件

接下来是触发生成事件。这个概念已经在上一节有所了解，不过"生成事件"这个名字比较具有迷惑性，实际上事件并不一定要在生成那一刻发生。正如现在所学，已存在的实体身上也可以再触发事件。跟上一节的`/summon`一样，`/event`后面的生成事件并不总是适用于所有对象，因此需要选对事件，并且灵活使用目标选择器来限定对象（和summon不同的是，这个命令是可以指定多个实体的）。

## 状态效果

下面是状态效果。这个命令我很早就开始用了，基本语法没什么好说的。有一些之前并没有留意的地方，在此啰嗦几句。

时长后面的那个数字实际上是放大倍率，也就是实际效果等级减去1。

时长的单位是秒，只能为整数，但是可以为0。0的时候可以清除特定效果。虽说大部分效果时长为秒，但是一些"瞬时"性效果（大名叫"即时生效效果"，其实就瞬间治疗、瞬间伤害和饱和这三种）的时长单位是游戏刻。你问为什么饱和也是以刻为单位？想一想谜之炖菜给的饱和效果时长你就知道了......

时长是可选参数，在不给予该参数的时候默认值为30。而相应的，上面的三个特例默认值就是1秒了（即30游戏刻）。

在1.21.40版本之后，这个命令追加了新语法，具体就是以下两种：时长可以为无限，对应参数的位置填`infinite`。*但是好像给无限时长的黑暗效果是不会生效的？等待验证...*另外，在`/effect xxx clear`的后面可以指定一个效果，也就是清除特定的效果（想清除无限时长效果只能用这种方法）。另外，还有一个一直都有的参数，只不过我没留意过：隐藏粒子效果。这个参数放在了最后面，要注意`true`是隐藏，反之则显示，要用的话可不要弄反了。

你知道吗：在无限时长语法实装进游戏之前，如果要实现近似无限时长的效果，通常会把时长设为1后面接许多个0，或者是一堆9。因此当你看到一个效果的剩余时长的分钟数是1666...这样的，其实就是因为时长为1000...（或999...）造成的。

## 施加伤害

关于伤害，首先我们要知道，一个所谓的伤害分为四个部分，通俗一点：谁掉了血（目标，可以是多个），掉了多少血（伤害值），因什么而掉血（成因，可以不写，这个时候伤害类型是`none`），以及谁（伤害者）让那个倒霉蛋掉血了。当然，有些成因是不需要有伤害者的，不过大部分情况下，如果不指定伤害者，那么做出伤害的对象就是指定的目标它自己~~（搬起石头砸自己的脚是吧）~~。

言归正传，这个命令可以灵活地扣除实体血量，哪怕是0也有效果。因此在回满了血量的前提下，这个命令就可以实现间接的控制实体血量。但是嘛，要先确保目标没有生命提升和伤害吸收效果，不然的话......懂的都懂。（村民斗铁傀儡：电子斗蛐蛐*感兴趣的话可以试一下铁傀儡大战铁傀儡，都有击退抗性就不会被打飞了，甚至你可以让它们边打，你在旁边给它们加铁锭修补~~不是这作者怎么这么皮啊~~*）

## 骑乘

唉，BE的许多命令都是JE的残血版，这条也不例外。应该说，在BE，坐骑和乘客的种类、数量都是有严格限制的，因此它的局限性很大。它有5条语法，接下来借用一下教程的内容，简单回顾一下各条语法：

- 令乘客开始骑乘坐骑。可设定传送规则（传送乘客/传送坐骑）和填充方式（都能骑乘时才允许骑乘/依次骑乘直到满员）。
- 令乘客停止骑乘关系。
- 令坐骑驱赶乘客。
- 为乘客生成一个坐骑。可设定骑乘规则（仅为既未骑乘也未被骑乘的实体生成乘客/让乘客停止骑乘后生成乘客/为非乘客生成坐骑）和待生成的坐骑的生成事件与名称。
- 为坐骑生成一个乘客。可设定待生成的乘客的生成事件与名称。

事实上，这么描述有些还是挺抽象的。不过如果要详细讲讲这条命令，~~估计又可以水不少字数了，~~因为篇幅有限，这里暂时就不进行详细说明了。

## 练习题部分

这几道题目的综合性都比较强，难度还行，仔细审题就好了。注：为了兼容性考虑，若无特殊说明，下文中我的作答将不会使用于1.20之后加入的新语法。

/// details | 真题回顾
    type: note

1. 使用`/event`，令所有苦力怕立刻开始爆炸！
2. 当有其他玩家靠近时，则施加隐身效果。提示：用`rm=0.01`来排除玩家自己。
3. 用命令将玩家的血量改为 5 点。请先回满所有血量再施加伤害。
4. 用两种命令方法移除玩家的中毒效果。
5. 为溺尸施加 1 点溺水伤害，为鸡施加 1 点摔落伤害。请通过实验验证哪条命令会执行失败？
///

### 各题目的分析 & 作答

**第1题**，提示很明显了，找到苦力怕的事件名字就好了。注意是立刻开始爆炸，而不是准备爆炸。

/// tab | 参考答案
```mcfunction {linenums="1"}
event entity @e[type=creeper] minecraft:start_exploding
```
或
```mcfunction {linenums="1"}
event entity @e[type=creeper] minecraft:start_exploding_force
```
///
/// tab | 我的作答
嗯，这回事件找对了。

```mcfunction {linenums="1"}
event entity @e[type=creeper] minecraft:start_exploding
```
///

---

**第2题**，如果有玩家靠近，根据题目提示，就是存在距离目标为0.01至5（没说是多近那就姑且算5吧）的玩家。之前还用过一个`rm=0`的用法，这个是用来检测指定维度的实体的，两者可不要搞混了。

/// tab | 参考答案
```mcfunction {linenums="1"}
execute as @a at @s if entity @a[rm=0.01,r=1] run effect @s invisibility 1 0 true
```
///

/// tab | 我的作答
我的命令也是符合要求的，只是某些细节上的差异。

```mcfunction {linenums="1"}
execute as @a at @s if entity @a[rm=0.01, r=5] run effect @s invisibility 99999
```
///

---

**第3题**，要将血量设为5点，正如上文所说，先要排除玩家的特殊状态效果，接着才是回血和扣血。回血没有命令，必须用状态效果，不过扣血就有专门的命令啦。

/// tab | 参考答案
```mcfunction {linenums="1"}
effect @a instant_health 5 100 true
damage @a 15
```
///

/// tab | 我的作答
执行效果一样，4级的瞬间治疗可以回32点血量，已经大于玩家默认的20点血量。

```mcfunction {linenums="1"}
effect @a health_boost 0
effect @a absorption 0
effect @a instant_health 1 3
damage @a 15
```
///

---

**第4题**，移除效果就是那两种方法，只不过有一种不兼容老版本。不过好像没说这个中毒效果是不是可致命的啊......那就都写上去吧。

/// tab | 参考答案
```mcfunction {linenums="1"}
effect @a clear poison
```
和
```mcfunction {linenums="1"}
effect @a poison 0 100 true
```
///

/// tab | 我的作答
```mcfunction {linenums="1"}
effect @a poison 0
effect @a fatal_poison 0
```
和
```mcfunction {linenums="1"}
effect @a clear poison
effect @a clear fatal_poison
```
///

---

**第5题**，要判断能否给一个生物施加特定种类的伤害。如果用`/damage`命令给一个免疫某种伤害的生物强行加上该伤害，那么命令会执行失败并报错。以我~~多年来~~的经验，鸡~~*坤*~~应该是免疫摔落伤害的。溺尸我不确定，但是都这么问了，那肯定是一个可以，另外一个不行了......

这里附上相关知识：

- 溺尸的ID为`drowned`。
- 鸡的ID为`chicken`。
- 溺水伤害的ID为`drowning`。
- 摔落伤害的ID为`fall`。

/// tab | 参考答案
`/damage @e[type=drowned] 1 drowning`和`/damage @e[type=chicken] 1 fall`，其中对鸡的伤害是无效的。失败原因在模块 3 会详细说明——这是由`minecraft:damage_sensor`组件决定的。
///
/// tab | 我的作答
经实测，执行伤害命令的结果为"已对溺尸施加伤害"和"无法对鸡施加伤害"。实际上就是因为鸡对摔落伤害免疫，而溺尸不免疫溺水伤害。
///

## 一些胡思乱想

接下来的内容，本来是在上面正文中的，但是写到最后，发现我的疑问实在是太多了（不过"学贵有疑"，这可是好事），在查询wiki以及请教各位开发大佬之后，我对这些问题有了更深的理解。为了避免正文过于臃肿，把一些比较有意思、有深度的问题放在这里，供大家品味。

---

*关于随机放置方块*

Q: 教程说可以用`/spreadplayers`来随机确定一个箱子的位置，以实现类似吃鸡游戏中随机刷空投箱的机制。但是这命令好像只能传送实体，而且用方块操作的`/setblock`之类的命令好像要指定一个精确坐标，那么是怎么实现随机刷箱子的呢？

A: 既然只能随机实体，那就借助辅助实体（例如盔甲架），在将辅助实体随机到指定范围内之后，用`/execute at`将位置设为实体的位置，接着利用`/clone`来复制箱子等方块。顺带一提，这条命令将会在2.8节学习到，这条命令比之前了解过的`/setblock`更加灵活，在学到2.8节的时候我们也会来好好聊聊它。

---

*关于状态效果的机制*

使用命令给予效果，需要的参数包括效果类型，时长和等级。若要对一个已经存在的效果给予一个新的，当新的等级高于旧的，直接覆盖掉，当等级相同时，比较时长，取时长多的那个。当新的等级小于旧的，不采取任何操作。可见，新效果是否覆盖旧效果，首先看等级，除非等级相同才会看时长。如果覆盖了等级，那么将使用新效果的时长，与旧效果的时长无关。

借助这个机制，可以推测出一种清除特定效果的方法，也就是给予一个最高级的0秒效果。这是说得通的，但是如果原效果就是最高级呢？幸好游戏想到了这一点。给予一个任意等级，时长为0秒的效果，其作用就是直接清除对应效果。也就是说只要时长是0秒，后面的等级大可不写。这一点也可以从命令执行反馈看出。给0秒效果时显示"已清除xxx的xx效果"，和正常情况下的"已给予xxx时长为x秒的xx效果"是不同的。实际上，有不少开发者，也许还包括屏幕前的你，都不太清楚0秒效果的机制。关于此的更多信息，wiki上亦有记载，可以阅读相关页面以加深理解。

---

*关于借助`/damage`控制玩家血量*

这种方法的关键思路是，先将玩家回满血量，然后再进行扣血。那么这里就有两个环节：回血和扣血。接下来我们来依次分析一下它们。

首先来看回血。因为没有专门的命令来增加血量，我们需要借助`/effect`命令给目标加上瞬间治疗效果来进行回血。这里顺便说一下，瞬间治疗的回血效果是，每一刻回复一定血量。回复量的计算公式是：2^(效果等级)颗心，开发中常用点数来表示血量。1心=2点，因此公式用血量点数表示为：2\*2^(效果等级)。（通过数学变形可以得到另一个形式，一个很简单的数学练习）玩家的默认血量是10颗心，即20点。因此通过一点小计算，可以得出4级的瞬间治疗，1刻就可以回32点，已经高于20。（不要忘记了，命令里面的效果倍数，是实际等级减去1）

接着就是扣血。想要给玩家留下多少点血，要扣的血量就是20减去剩下的血量。但是由于伤害的设定，在扣血的一瞬间，玩家视角是有受击反馈的。但鉴于控血使用率低，而且目前所学知识有限，就先将就用这种方法吧。

还有一点需要注意：如果玩家有生命提升或者伤害吸收，将会导致回血和扣血之后剩余血量偏离预期。但是一般地图都应该严格控制玩家的状态效果，若有给予特殊效果，在控制血量时，按照目前所学，应该先移除对应效果再进行。另外，回血的状态效果可以视情况隐藏粒子效果。不管怎样要记住一个道理，需要什么额外的操作取决于实际的开发需求。

## 结语

其实上面的练习题只聚焦了几个较高频的命令，传送和骑乘因为是简单了解，所以没安排题目。有些题目可能是我想多了，有所顾虑。实际上这些题目只是检测我对知识的掌握程度，只要语法不出错就没问题。我与答案的差异主要是对背景、需求理解不同。不过毕竟是别人出的题，到头来学习的知识还是要为自己服务。在实际开发中，要坚持这种细致的精神，考虑得全面，写出的代码就能最好地符合预期了。做好查漏补缺，继续向下一节进发！
